# Param Extraction Blockers (Blinkbolt & AoW Behavior Chains)

This note documents everything we tried to surface missing behavior/damage data for Blinkbolt and other unmatched Ashes/skills, what we actually found, and what remains blocking.

## What we attempted

- Parsed every TAE in the repo for Behavior events (type 304, the only TAE event that carries `behaviorJudgeId`). Sources scanned:
  - `PARAM/tae_behavior_map/tae/c0000/*.tae`
  - `dump/tae_collected/*.tae` (925 files, 106 with any 304 events)
  - `dump/c_.anibnd/*.hkx` contains no TAEs; verified no 304 events there.
- Re-ran `scripts/tae_dump_behaviors.py` on all TAEs above; consolidated behavior IDs into `work/tae_behavior_map/behaviors_dump.json`.
- Mined `BehaviorParam_PC.csv` by name (e.g., rows labeled “Shared [AOW] …”) to build a behavior map when TAEs did not provide IDs. Stored in `work/tae_behavior_map/behavior_ids_param.json` and regenerated `work/skill_dump.json` with it.
- Full-text search across all decompressed content (PARAM, smithbox_dump, dump/, docs, msg XML/JSON, work/) for the Blinkbolt identifiers: AoW ID `413000`, swordArts `4130`/`5130`/`5140`, and custom-weapon IDs `1413020`–`1413062`.
- Inspected SwordArtsParam (Blinkbolt entries show `swordArtsTypeNew=280`, offset from a600; the corresponding `a880.tae` has no type-304 events).
- Attempted to unpack additional TAEs from `*.anibnd(.dcx)` with Yabber under mono/wine; ended up with the same TAEs already present in the repo (no new behavior events surfaced).

## Findings

- TAEs we have only expose the small generic behaviorJudgeId set: `{111, 165, 192, 193, 470, 500, 501, 510, 511, 515, 516, 530, 531, 550, 560, 561, 603, 3026, 3027, 6862}`. No sword-art–specific IDs (e.g., 430–439) appear in any scanned TAE.
- BehaviorParam_PC has no rows named “Blinkbolt” (or similar) and no rows referencing 4130/14130xx. The only matches by name are “Shared [AOW] …” for other skills; those populate 68/112 skills via `behavior_ids_param.json`. Blinkbolt and ~44 others remain without behavior mappings.
- Magic: no rows with `refId*` starting `4130` and no rows named Blinkbolt. Thus no Magic → Bullet/Atk/SpEffect chain for Blinkbolt in the player params.
- Bullet/Atk/SpEffect: IDs starting with 413xxxxx exist only for NPC “Demi-Human Queen” dummy entries (`atkAttribute=254`, `isAttackSFX=0`), not tied to the player AoW.
- EquipParamCustomWeapon rows (1413020–1413062) enumerate prebuilt “Lightning <weapon> - Blinkbolt” instances (base weapon + gem + reinforce), but do not link to BehaviorParam or Magic/Bullet/Atk chains. CharaInitParam references them as starting gear, nothing else.
- SwordArtsParam entries exist (4130 Blinkbolt, 5130 Twinaxe, 5140 Long-hafted Axe) with `swordArtsTypeNew=280`, but the corresponding offset TAE (`a880.tae`) has zero type-304 events.

## Current state (work/skill_dump.json)

- Behavior sections are populated for 68/112 skills using `behavior_ids_param.json` (name-matched BehaviorParam_PC rows).
- The remaining 44 skills (including Blinkbolt and its variants) have empty `behavior` blocks; only Magic-derived data is present, and Blinkbolt lacks Magic refs entirely.

## What’s blocking

- We have no source of behaviorJudgeIds for Blinkbolt (and other unmatched AoWs): no TAE type-304 events, no BehaviorParam_PC name hits, no Magic refIds, and no player Bullet/Atk rows keyed by the skill ID.

## What we need next

1) A behavior ID map for the unmatched skills: `skill_id -> [behaviorJudgeId...]` (variationId=0 for AoWs), sourced from TAEs that actually fire those behaviors or manual pairing to specific BehaviorParam_PC rows.
2) If new TAEs exist that include the missing type-304 events, add them and rerun `scripts/tae_dump_behaviors.py`; otherwise, we need manual IDs.

## Commands of record

- Scan TAEs for behavior events: `python scripts/tae_dump_behaviors.py --tae-root dump/tae_collected --out work/tae_behavior_map/behaviors_dump.json`
- Build behavior map from BehaviorParam names: see `work/tae_behavior_map/behavior_ids_param.json` (generated by heuristic name matching in `BehaviorParam_PC.csv`).
- Regenerate skill dump with current map: `python scripts/skill_dump.py --skills work/responses/ready/skill.json --behavior-map work/tae_behavior_map/behavior_ids_param.json --out work/skill_dump.json`

If you can provide behaviorJudgeIds for the remaining skills (e.g., Blinkbolt), I can wire them into the map and refresh `work/skill_dump.json` to include full Behavior → Bullet/Atk/SpEffect chains.
